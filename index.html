
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SuccessStudent - Plagiarism Checker, Writing Corrector, MLA &amp; Humanizer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class', // Enabled class-based dark mode
      theme: {
        extend: {
          colors: {
            primary: '#0052cc', 
            secondary: '#f4f5f7', // Light mode background
            accent: '#0065ff', 
            success: '#36b37e', 
            warning: '#ffab00', 
            danger: '#ff5630', 
            textDark: '#172b4d', // Light mode main text
            textLight: '#42526e', // Light mode secondary text
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', '"Noto Sans"', 'sans-serif', '"Apple Color Emoji"', '"Segoe UI Emoji"', '"Segoe UI Symbol"', '"Noto Color Emoji"'],
            serif: ['"Times New Roman"', 'Times', 'ui-serif', 'Georgia', 'Cambria', '"serif"'],
          }
        }
      }
    }
  </script>
  <style>
    .font-times-12pt {
      font-family: "Times New Roman", Times, serif;
      font-size: 12pt;
    }
  </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/client": "https://esm.sh/react-dom@^19.1.0/client",
    "@google/genai": "https://esm.sh/@google/genai@^1.0.1",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/"
  }
}
</script>
</head>
<body class="bg-secondary dark:bg-gray-900"> 
  <div id="root"></div>

  <script type="module">
    import React, { useState, useCallback, useEffect, StrictMode } from 'react';
    import ReactDOM from 'react-dom/client';
    import { GoogleGenAI } from '@google/genai';

    // --- START of types.ts content ---
    const CheckType = {
      WEB: 'web',
      DIRECT: 'direct',
    };

    const GRADE_LEVEL_OPTIONS = [
      { value: "", label: "Select Grade Level..." },
      { value: "Elementary", label: "Elementary School" },
      { value: "6th Grade", label: "6th Grade" },
      { value: "7th Grade", label: "7th Grade" },
      { value: "8th Grade", label: "8th Grade" },
      { value: "9th Grade", label: "9th Grade" },
      { value: "10th Grade", label: "10th Grade" },
      { value: "11th Grade", label: "11th Grade" },
      { value: "12th Grade", label: "12th Grade" },
      { value: "College", label: "College" },
    ];

    const SynonymFinderMode = {
      SINGLE_WORD: 'singleWord',
      SENTENCE: 'sentence',
    };
    // --- END of types.ts content ---

    // --- START of components/IconComponents.tsx content ---
    const BookOpenIcon = ({ className }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: `w-6 h-6 ${className}` },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" })
      )
    );

    const DocumentMagnifyingGlassIcon = ({ className }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: `w-6 h-6 ${className}` },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 10.875a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" })
      )
    );

    const LightBulbIcon = ({ className }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: `w-6 h-6 ${className}` },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a12.06 12.06 0 0 1-4.5 0m4.5-4.708v.6A2.25 2.25 0 0 1 13.5 18v.217m-2.25-2.217v-.Û¶a2.25 2.25 0 0 0-2.25-2.25v-.217m0 0V5.625A2.25 2.25 0 0 1 9 3.375h6A2.25 2.25 0 0 1 17.25 5.625v3.375m0 0c0 .267.03.53.086.786m-6.764-.786a6.726 6.726 0 0 0-3.182 0c-.133-.256-.214-.536-.214-.833m10.142 0c.056-.256.086-.52.086-.786 0-.307-.058-.577-.172-.833m-4.546 2.484c.133.256.214.536.214.833 0 .307-.058.577-.172.833m-2.25-4.132a6.726 6.726 0 0 1 3.182 0c.133.256.214.536.214.833s-.081.577-.214.833m-7.074 0c-.133-.256-.214-.536-.214-.833s.081-.577.214-.833M5.625 11.953c.133-.256.214-.536.214-.833s-.081-.577-.214-.833m0 0a6.732 6.732 0 0 0-3.182 0c-.069.13-.128.265-.172.4M3.375 9a6.75 6.75 0 0 1 17.25 0c0 .204-.01.406-.03.603m-17.22 0A6.732 6.732 0 0 1 3.375 9Z" })
      )
    );

    const WandSparklesIcon = ({ className }) => (
      React.createElement('svg', {
        xmlns: "http://www.w3.org/2000/svg",
        fill: "none",
        viewBox: "0 0 24 24",
        strokeWidth: 1.5,
        stroke: "currentColor",
        className: `w-6 h-6 ${className}`
      },
        React.createElement('path', {
          strokeLinecap: "round",
          strokeLinejoin: "round",
          d: "M10.5 21l-1.924-4.618L4 14.5l4.618-1.924L10.5 8l1.924 4.618L17 14.5l-4.618 1.924L10.5 21zM16.5 3l-1.025 2.46L13 6.5l2.46 1.025L16.5 10l1.025-2.46L20 6.5l-2.46-1.025L16.5 3zM6 2.25L5.25 4 4 4.75l1.25.75L6 7.25l.75-1.75L8 4.75 6.75 4 6 2.25z"
        })
      )
    );

    const AcademicCapIcon = ({ className }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: `w-6 h-6 ${className}` },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M4.26 10.147a60.436 60.436 0 0 0-.491 6.347A48.627 48.627 0 0 1 12 20.904a48.627 48.627 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.57 50.57 0 0 0-2.658-.813A59.905 59.905 0 0 1 12 3.493a59.902 59.902 0 0 1 10.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0 1 12 13.489a50.702 50.702 0 0 1 7.74-3.342M6.75 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm0 0v-3.675A55.378 55.378 0 0 1 12 8.443m-7.007 1.755A57.081 57.081 0 0 1 12 8.443m0 0A57.081 57.081 0 0 1 19.007 10.2m0 0V15m0 0v2.25m0 0a1.5 1.5 0 0 0 1.5 1.5h1.5M12 10.875a3.375 3.375 0 1 0 0 6.75 3.375 3.375 0 0 0 0-6.75Z" })
      )
    );

    const UserGroupIcon = ({ className }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", className: `w-6 h-6 ${className}` },
        React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m8.007 0a3 3 0 0 0-4.682 2.72M12 12.75a3 3 0 1 1 0-6 3 3 0 0 1 0 6Zm0 0H12m0-6H12m0 0H12m0 0V6m6 6.75v.75A3 3 0 0 1 15 21h-1.5m1.5 0V18M9 18.75V21a3 3 0 0 0 3-3h-1.5m1.5 0V18m-3 0v-2.25A18.002 18.002 0 0 1 12 3.75m0 0a18.002 18.002 0 0 1 5.25 2.25M12 3.75V1.5m0 0V3.75m0 0a18.002 18.002 0 0 0-5.25 2.25M12 3.75V6" })
      )
    );
    // --- END of components/IconComponents.tsx content ---

    // --- START of components/LoadingSpinner.tsx content ---
    const LoadingSpinner = ({ className, size = 'sm' }) => {
      const sizeClasses = { sm: 'h-5 w-5', md: 'h-8 w-8', lg: 'h-12 w-12' };
      return (
        React.createElement('svg', {
          className: `animate-spin ${sizeClasses[size]} text-white ${className || ''}`, // text-white works on dark blue button
          xmlns: "http://www.w3.org/2000/svg",
          fill: "none",
          viewBox: "0 0 24 24",
          role: "status",
          'aria-live': "polite",
          'aria-label': "Loading"
        },
          React.createElement('circle', { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }),
          React.createElement('path', { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" })
        )
      );
    };
    // --- END of components/LoadingSpinner.tsx content ---

    // --- START of components/TextInput.tsx content ---
    const TextInput = ({ className, type = "text", ...props }) => {
      const commonClasses = `
        block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm 
        focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary 
        dark:focus:ring-offset-gray-800
        sm:text-sm transition-shadow duration-150 ease-in-out
        placeholder-gray-400 dark:placeholder-gray-500 
        bg-white dark:bg-gray-700 text-textDark dark:text-gray-200
        ${props.readOnly ? 'bg-gray-100 dark:bg-gray-600 cursor-not-allowed' : ''}
      `;

      if (props.rows) { // For textarea
        return React.createElement('textarea', {
          ...props,
          className: `${commonClasses} ${className || ''}`
        });
      }
      // For input
      return React.createElement('input', {
        type: type,
        ...props,
        className: `${commonClasses} ${className || ''}`
      });
    };
    // --- END of components/TextInput.tsx content ---

    // --- START of components/SelectDropdown.tsx content ---
    const SelectDropdown = ({ id, name, value, onChange, options, className, 'aria-label': ariaLabel }) => {
      const commonClasses = `
        block w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm 
        focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary 
        dark:focus:ring-offset-gray-800
        sm:text-sm transition-shadow duration-150 ease-in-out
        bg-white dark:bg-gray-700 text-textDark dark:text-gray-200
        cursor-pointer
      `;
      return (
        React.createElement('select', {
          id: id,
          name: name,
          value: value,
          onChange: onChange,
          className: `${commonClasses} ${className || ''}`,
          'aria-label': ariaLabel
        },
          options.map(option => (
            React.createElement('option', { key: option.value, value: option.value, disabled: option.value === "" && option.label.includes("Select") },
              option.label
            )
          ))
        )
      );
    };
    // --- END of components/SelectDropdown.tsx content ---
    
    // --- START of components/RadioGroup.tsx content ---
    const RadioGroup = ({ options, selectedValue, onChange, name, className }) => {
      return (
        React.createElement('fieldset', { className: `space-y-2 md:space-y-0 md:flex md:space-x-4 ${className || ''}` },
          React.createElement('legend', { className: "sr-only" }, name),
          options.map((option) => (
            React.createElement('div', { key: option.value, className: "flex items-center" },
              React.createElement('input', {
                id: `${name}-${option.value}`,
                name: name,
                type: "radio",
                value: option.value,
                checked: selectedValue === option.value,
                onChange: (e) => onChange(e.target.value),
                className: "focus:ring-primary h-4 w-4 text-primary border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:checked:bg-primary dark:focus:ring-offset-gray-800 cursor-pointer"
              }),
              React.createElement('label', {
                htmlFor: `${name}-${option.value}`,
                className: "ml-3 block text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer"
              }, option.label)
            )
          ))
        )
      );
    };
    // --- END of components/RadioGroup.tsx content ---

    // --- START of services/geminiService.ts content ---
    let geminiAIInstance = null;
    const WEB_CHECK_MODEL = 'gemini-2.5-flash-preview-04-17';
    const COMPARISON_MODEL = 'gemini-2.5-flash-preview-04-17';
    const CORRECTION_MODEL = 'gemini-2.5-flash-preview-04-17';
    const MLA_FORMAT_MODEL = 'gemini-2.5-flash-preview-04-17';
    const HUMANIZER_MODEL = 'gemini-2.5-flash-preview-04-17';
    const SYNONYM_FINDER_MODEL = 'gemini-2.5-flash-preview-04-17';

    function initializeGeminiService(userProvidedKey = null) {
      if (geminiAIInstance) {
        console.log("Gemini service already initialized.");
        return true; // Already initialized
      }

      let apiKeyToUse = userProvidedKey;

      if (!apiKeyToUse) {
        // Ensure process.env exists, especially in browser environments without build tools
        if (typeof process === 'undefined') {
          window.process = { env: {} };
        }
        apiKeyToUse = process.env.API_KEY || window.GEMINI_API_KEY_FOR_DEV;
      }
      
      if (!apiKeyToUse) {
        // If no key was provided by user and no key found in env/window
        if (!userProvidedKey) {
            console.warn("API Key not found automatically. User will be prompted.");
            return 'API_KEY_REQUIRED'; 
        }
        // If user provided a key but it was falsy (e.g. empty string)
        return "Invalid API Key provided. Please enter a valid key.";
      }

      try {
        geminiAIInstance = new GoogleGenAI({ apiKey: apiKeyToUse });
        console.log("Gemini service initialized successfully.");
        return true;
      } catch (error) {
        console.error("Failed to initialize Gemini Service:", error);
        geminiAIInstance = null; // Ensure it's null on failure
        return `Failed to initialize Gemini Service: ${error.message}. Please check your API key.`;
      }
    }
    
    function parseWebCheckResponse(responseText) {
      const cleanedText = responseText.replace(/```json/g, '').replace(/```/g, '').trim();
      const aiScoreMatch = cleanedText.match(/AI_SCORE:\s*(\d+)/i);
      const plagiarismScoreMatch = cleanedText.match(/PLAGIARISM_SCORE:\s*(\d+)/i);
      const analysisMatch = cleanedText.match(/ANALYSIS:\s*([\s\S]*?)(?=\nSOURCES:|\n$)/i);
      const sourcesBlockMatch = cleanedText.match(/SOURCES:\s*([\s\S]*)/i);

      const aiContentScore = aiScoreMatch ? parseInt(aiScoreMatch[1], 10) : 0;
      const plagiarismScore = plagiarismScoreMatch ? parseInt(plagiarismScoreMatch[1], 10) : 0;
      const analysisSummary = analysisMatch ? analysisMatch[1].trim() : "Analysis not available.";
      
      const sources = [];
      if (sourcesBlockMatch && sourcesBlockMatch[1] && sourcesBlockMatch[1].trim().toLowerCase() !== "none") {
        const sourceLines = sourcesBlockMatch[1].trim().split('\n');
        sourceLines.forEach(line => {
          const titleMatch = line.match(/-\s*Title:\s*(.*?),\s*URI:\s*(.*)/i);
          if (titleMatch && titleMatch[1] && titleMatch[2]) {
            sources.push({ title: titleMatch[1].trim(), uri: titleMatch[2].trim() });
          }
        });
      }
      return { aiContentScore, plagiarismScore, analysisSummary, sources, rawResponse: responseText };
    }

    async function checkTextWithGemini(text) {
      if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");
      
      const prompt = `
Analyze the following text.
1. Assess if it seems AI-generated. Provide an AI Content Likelihood score from 0 (definitely human) to 100 (definitely AI).
2. Check for potential plagiarism by comparing it against web content. Provide a Plagiarism Score from 0 (no plagiarism) to 100 (highly plagiarized).
3. Provide a brief overall analysis.
4. If web sources are found from Google Search, list their URIs and titles.

Respond in the following format STRICTLY:
AI_SCORE: [score_value]
PLAGIARISM_SCORE: [score_value]
ANALYSIS: [your_analysis_text]
SOURCES:
- Title: [title1], URI: [uri1]
- Title: [title2], URI: [uri2]
(list sources if any, otherwise "SOURCES: None")

TEXT_TO_ANALYZE:
\`\`\`
${text}
\`\`\`
`;
      try {
        const response = await geminiAIInstance.models.generateContent({
          model: WEB_CHECK_MODEL,
          contents: prompt,
          config: { tools: [{googleSearch: {}}] }
        });
        
        const responseText = response.text;
        const parsedResult = parseWebCheckResponse(responseText);

        const groundingMetadata = response.candidates?.[0]?.groundingMetadata;
        if (groundingMetadata?.groundingChunks && groundingMetadata.groundingChunks.length > 0) {
            const webSourcesFromGrounding = groundingMetadata.groundingChunks
                .filter(chunk => chunk.web && chunk.web.uri && chunk.web.title)
                .map(chunk => ({ title: chunk.web.title, uri: chunk.web.uri }));
            
            const existingUris = new Set(webSourcesFromGrounding.map(s => s.uri));
            parsedResult.sources.forEach(ps => {
                if (!existingUris.has(ps.uri)) webSourcesFromGrounding.push(ps);
            });
            parsedResult.sources = webSourcesFromGrounding;
        }
        return parsedResult;
      } catch (error) {
        console.error("Error in checkTextWithGemini:", error);
        throw new Error(`Failed to analyze text with web check: ${error.message || 'Unknown Gemini API error'}`);
      }
    }

    async function compareTextsWithGemini(text1, text2) {
      if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");

      const prompt = `
You are a text comparison expert. Compare Text 1 and Text 2.
1. Calculate a similarity score from 0 (completely different) to 100 (identical).
2. Provide a detailed summary of the similarities and differences.
3. List up to 5 key matching phrases or sentences if significant overlap is found.

Respond strictly in JSON format with the following structure:
{
  "similarityScore": number,
  "comparisonSummary": string,
  "matchingSegments": string[]
}

Text 1:
\`\`\`
${text1}
\`\`\`

Text 2:
\`\`\`
${text2}
\`\`\`
`;
      let rawGeminiResponseText;
      try {
        const response = await geminiAIInstance.models.generateContent({
          model: COMPARISON_MODEL,
          contents: prompt,
          config: { responseMimeType: "application/json" }
        });
        rawGeminiResponseText = response.text;
        let jsonStr = rawGeminiResponseText.trim();
        const fenceRegex = /^\`\`\`(\w*)?\s*\n?(.*?)\n?\s*\`\`\`$/s;
        const match = jsonStr.match(fenceRegex);
        if (match && match[2]) jsonStr = match[2].trim();
        
        const parsedData = JSON.parse(jsonStr);
        return parsedData;
      } catch (error) {
        console.error("Error in compareTextsWithGemini:", error);
        if (error instanceof SyntaxError) {
            throw new Error(`Failed to parse JSON response from Gemini: ${error.message}. Raw response: ${rawGeminiResponseText || '[Raw response text not captured]'}`);
        }
        throw new Error(`Failed to compare texts: ${error.message || 'Unknown Gemini API error'}`);
      }
    }

    async function fixTextWithGemini(textToFix) {
      if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");

      const prompt = `
You are an expert editor. Please review the following text. Correct any grammatical errors, spelling mistakes, awkward phrasing, and improve overall clarity and flow. Strive to preserve the original meaning and tone of the text.
Return ONLY the corrected text, without any of your own conversational text, introductions, or explanations.

Original Text:
"""
${textToFix}
"""

Corrected Text:
`;
      try {
        const response = await geminiAIInstance.models.generateContent({
          model: CORRECTION_MODEL,
          contents: prompt,
        });
        return response.text.trim();
      } catch (error) {
        console.error("Error in fixTextWithGemini:", error);
        throw new Error(`Failed to correct text: ${error.message || 'Unknown Gemini API error'}`);
      }
    }

    async function formatTextToMLA(details) {
        const { studentName, instructorName, courseName, date, textToFormat } = details;
        if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");

        const prompt = `
You are an expert in academic writing and MLA formatting (9th edition).
Format the provided information and text according to MLA guidelines.

Follow these instructions meticulously:

1.  **MLA Header:** Create the following MLA header, left-aligned. Each item must be on a new line and double-spaced (one blank line between each header line):
    *   ${studentName}
    *   ${instructorName}
    *   ${courseName} (Ensure proper title case capitalization, e.g., "English 101", "History of Art 203B")
    *   ${date} (Format this date as Day Month Year, e.g., "15 May 2024")

2.  **Spacing Between Header and Body:** There must be exactly one double space (one blank line) between the last line of the header (the date) and the first line of the essay body.

3.  **Essay Body Formatting:**
    *   The entire body text must be double-spaced. This means one blank line between all lines of text, and one blank line between paragraphs.
    *   The first line of each new paragraph in the body text must be indented by 0.5 inches (represent this with 5 spaces if tab characters are an issue in plain text output).
    *   Maintain the integrity and content of the original text.

4.  **General Formatting:**
    *   The overall document should be structured as if it were for 12pt Times New Roman font.
    *   Do not add page numbers.
    *   Do not add a "Works Cited" page or attempt to create citations.
    *   Do not use any markdown formatting (like \`\`\`, \`*\`, \`#\`) in your output.

Return ONLY the complete formatted text (header followed by the formatted body). Do not include any of your own conversational text, introductions, explanations, apologies, or any text other than the formatted document itself.

Original Text to Format:
"""
${textToFormat}
"""

MLA Formatted Document (Header and Body):
`;
        try {
            const response = await geminiAIInstance.models.generateContent({
                model: MLA_FORMAT_MODEL,
                contents: prompt,
            });
            let formattedText = response.text.trim();
            const fenceRegex = /^```(\w*)?\s*\n?(.*?)\n?\s*```$/s;
            const match = formattedText.match(fenceRegex);
            if (match && match[2]) {
              formattedText = match[2].trim();
            }
            return formattedText;
        } catch (error) {
            console.error("Error in formatTextToMLA:", error);
            throw new Error(`Failed to format text to MLA: ${error.message || 'Unknown Gemini API error'}`);
        }
    }

    async function humanizeTextWithGemini(textToHumanize, gradeLevel) {
        if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");
        
        let audienceDescription = `${gradeLevel} students/readers`;
        if (gradeLevel === "Elementary") {
            audienceDescription = "Elementary school students";
        } else if (gradeLevel === "College") {
            audienceDescription = "College students/readers";
        }

        const prompt = `
You are an expert in transforming text to feel more natural, human, and engaging for a specific audience.
The user wants to humanize the following text for ${audienceDescription}.

Please rewrite the text focusing on these key aspects:
1.  **Natural Flow & Readability:** Ensure the language is smooth, easy to understand, and avoids jargon or overly complex sentences inappropriate for ${audienceDescription}.
2.  **Emotional Resonance & Empathy:** If applicable to the content, imbue the text with appropriate emotion or a sense of understanding/connection. Make it feel like it's written by a human who cares about the topic and the reader.
3.  **Clarity & Purpose:** The core message should be clear and direct. The purpose of the text should be evident.
4.  **Authenticity & Human-like Expression:** Avoid robotic or overly formal tones (unless the original text's purpose demands it and can be made more *authentically* formal). Use varied sentence structures and engaging vocabulary suitable for ${audienceDescription}.
5.  **Tone Adjustment:** Adjust the tone to be appropriate for ${audienceDescription} and the content. For example, more enthusiastic for younger audiences, more nuanced for older ones.
6.  **Preserve Core Meaning:** Ensure the original meaning and intent of the text are preserved during humanization.

Return ONLY the humanized text. Do not include any of your own conversational text, introductions, explanations, apologies, or any text other than the rewritten content itself. Do not use markdown formatting in your response.

Original Text:
"""
${textToHumanize}
"""

Humanized Text for ${audienceDescription}:
`;
        try {
            const response = await geminiAIInstance.models.generateContent({
                model: HUMANIZER_MODEL,
                contents: prompt,
            });
            let humanizedText = response.text.trim();
            const fenceRegex = /^```(\w*)?\s*\n?(.*?)\n?\s*```$/s;
            const match = humanizedText.match(fenceRegex);
            if (match && match[2]) {
              humanizedText = match[2].trim();
            }
            return humanizedText;
        } catch (error) {
            console.error("Error in humanizeTextWithGemini:", error);
            throw new Error(`Failed to humanize text: ${error.message || 'Unknown Gemini API error'}`);
        }
    }

    async function findSynonymsWithGemini(inputText, wordsToReplaceInSentence, mode) {
      if (!geminiAIInstance) throw new Error("Gemini Service not initialized. Please ensure the API key is correctly configured.");
      
      let prompt;
      if (mode === SynonymFinderMode.SENTENCE) {
        prompt = `
You are a vocabulary expert specializing in contextual synonyms.
Analyze the following sentence:
"${inputText}"

The user wants to find synonyms for the following word(s) from this sentence: "${wordsToReplaceInSentence.join(', ')}".
For each specified word, provide up to 5 contextually appropriate synonyms that would fit well within the original sentence.
If a specified word is not found in the sentence, its "synonyms" array should be empty and a message "Word not found in sentence." should be provided in the "message" field for that word.

Return your response ONLY in JSON format with the following structure. Do not include any other text or explanations outside of the JSON structure.
{
  "sentenceSynonyms": [
    {
      "originalWord": "word1",
      "synonyms": ["synonym1a", "synonym1b"],
      "message": "" 
    },
    {
      "originalWord": "word2",
      "synonyms": [],
      "message": "Word not found in sentence."
    }
  ],
  "error": null 
}
If there's a general issue with the request (e.g., sentence is too short or nonsensical for analysis), populate the main "error" field and "sentenceSynonyms" can be null or empty.
`;
      } else { // SynonymFinderMode.SINGLE_WORD
        prompt = `
You are a thesaurus expert.
Provide a list of up to 10 common synonyms for the word: "${inputText}".

Return your response ONLY in JSON format with the following structure. Do not include any other text or explanations outside of the JSON structure.
{
  "singleWordSynonyms": ["synonym1", "synonym2", "synonym3"],
  "error": null 
}
If the word is not found, invalid, or too ambiguous for synonyms, the "singleWordSynonyms" array should be empty or null, and the "error" field should contain a brief explanation (e.g., "Word not found or invalid.").
`;
      }

      let rawGeminiResponseText;
      try {
        const response = await geminiAIInstance.models.generateContent({
          model: SYNONYM_FINDER_MODEL,
          contents: prompt,
          config: { responseMimeType: "application/json" }
        });
        rawGeminiResponseText = response.text;
        let jsonStr = rawGeminiResponseText.trim();
        const fenceRegex = /^\`\`\`(\w*)?\s*\n?(.*?)\n?\s*\`\`\`$/s;
        const match = jsonStr.match(fenceRegex);
        if (match && match[2]) {
          jsonStr = match[2].trim();
        }
        
        const parsedData = JSON.parse(jsonStr);
        if (parsedData.error) {
            console.warn("Gemini returned an error for synonym finding:", parsedData.error);
        }
        return parsedData;
      } catch (error) {
        console.error("Error in findSynonymsWithGemini:", error);
        if (error instanceof SyntaxError) {
            throw new Error(`Failed to parse JSON response from Gemini for synonyms: ${error.message}. Raw response: ${rawGeminiResponseText || '[Raw response text not captured]'}`);
        }
        throw new Error(`Failed to find synonyms: ${error.message || 'Unknown Gemini API error'}`);
      }
    }
    // --- END of services/geminiService.ts content ---
    
    // --- START of components/ResultsDisplay.tsx content ---
    const ScoreBar = ({ score, label, colorClass }) => (
      React.createElement('div', { className: "mb-3" },
        React.createElement('div', { className: "flex justify-between mb-1" },
          React.createElement('span', { className: "text-sm font-medium text-gray-700 dark:text-gray-300" }, label),
          React.createElement('span', { className: `text-sm font-medium ${colorClass.replace('bg-', 'text-')}` }, `${score}%`) // Ensure text color matches bar color semantic
        ),
        React.createElement('div', { className: "w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5" },
          React.createElement('div', {
            className: `h-2.5 rounded-full ${colorClass}`,
            style: { width: `${Math.max(0, Math.min(100, score))}%` }
          })
        )
      )
    );

    const WebCheckResults = ({ data }) => {
      const getScoreColor = (score) => { // These classes are bg-colors
        if (score > 70) return 'bg-danger text-danger'; 
        if (score > 40) return 'bg-warning text-warning';
        return 'bg-success text-success';
      };
      return (
        React.createElement(React.Fragment, null,
          React.createElement('h3', { className: "text-xl font-semibold text-primary mb-3" }, "Web Analysis Report"),
          React.createElement(ScoreBar, { score: data.aiContentScore, label: "AI Content Likelihood", colorClass: getScoreColor(data.aiContentScore) }),
          React.createElement(ScoreBar, { score: data.plagiarismScore, label: "Plagiarism Score", colorClass: getScoreColor(data.plagiarismScore) }),
          React.createElement('div', { className: "mt-4" },
            React.createElement('h4', { className: "text-md font-semibold text-gray-700 dark:text-gray-300 mb-1" }, "Analysis Summary:"),
            React.createElement('p', { className: "text-sm text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 p-3 rounded-md whitespace-pre-wrap" }, data.analysisSummary)
          ),
          data.sources && data.sources.length > 0 && (
            React.createElement('div', { className: "mt-4" },
              React.createElement('h4', { className: "text-md font-semibold text-gray-700 dark:text-gray-300 mb-1" }, "Potential Sources Found:"),
              React.createElement('ul', { className: "list-disc list-inside space-y-1 bg-gray-50 dark:bg-gray-700 p-3 rounded-md max-h-60 overflow-y-auto" },
                data.sources.map((source, index) => (
                  React.createElement('li', { key: index, className: "text-sm text-gray-600 dark:text-gray-300" },
                    React.createElement('a', {
                      href: source.uri,
                      target: "_blank",
                      rel: "noopener noreferrer",
                      className: "text-primary hover:text-accent hover:underline",
                      title: source.uri
                    }, source.title || source.uri)
                  )
                ))
              )
            )
          )
        )
      );
    };

    const DirectComparisonResults = ({ data }) => {
      const getScoreColor = (score) => { // These classes are bg-colors
        if (score > 70) return 'bg-success text-success'; 
        if (score > 40) return 'bg-yellow-500 text-yellow-500'; 
        return 'bg-blue-500 text-blue-500';   
      };
      return (
        React.createElement(React.Fragment, null,
          React.createElement('h3', { className: "text-xl font-semibold text-primary mb-3" }, "Direct Comparison Report"),
          React.createElement(ScoreBar, { score: data.similarityScore, label: "Similarity Score", colorClass: getScoreColor(data.similarityScore) }),
          React.createElement('div', { className: "mt-4" },
            React.createElement('h4', { className: "text-md font-semibold text-gray-700 dark:text-gray-300 mb-1" }, "Comparison Summary:"),
            React.createElement('p', { className: "text-sm text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 p-3 rounded-md whitespace-pre-wrap" }, data.comparisonSummary)
          ),
          data.matchingSegments && data.matchingSegments.length > 0 && (
            React.createElement('div', { className: "mt-4" },
              React.createElement('h4', { className: "text-md font-semibold text-gray-700 dark:text-gray-300 mb-1" }, "Key Matching Segments:"),
              React.createElement('ul', { className: "list-disc list-inside space-y-1 bg-gray-50 dark:bg-gray-700 p-3 rounded-md" },
                data.matchingSegments.map((segment, index) => (
                  React.createElement('li', { key: index, className: "text-sm text-gray-600 dark:text-gray-300 italic" }, `"${segment}"`)
                ))
              )
            )
          )
        )
      );
    };

    const ResultsDisplay = ({ results, checkType }) => {
      if (!results) return null;
      return (
        React.createElement('section', { 'aria-labelledby': "results-heading", className: "mt-8 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700" },
          React.createElement('h2', { id: "results-heading", className: "sr-only" }, "Analysis Results"),
          checkType === CheckType.WEB && results && 'plagiarismScore' in results ? (
            React.createElement(WebCheckResults, { data: results })
          ) : checkType === CheckType.DIRECT && results && 'similarityScore' in results ? (
            React.createElement(DirectComparisonResults, { data: results })
          ) : (
            React.createElement('p', { className: "text-gray-500 dark:text-gray-400" }, "No results to display or result type mismatch.")
          )
        )
      );
    };
    // --- END of components/ResultsDisplay.tsx content ---

    // --- START of SuccessStudentTool.tsx content ---
    const SuccessStudentTool = ({ onBack }) => {
      const [primaryText, setPrimaryText] = useState('');
      const [comparisonText, setComparisonText] = useState('');
      const [currentCheckType, setCurrentCheckType] = useState(CheckType.WEB);
      const [results, setResults] = useState(null);
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleCheck = useCallback(async () => {
        if (!primaryText.trim()) {
          setError('Please enter the text you want to check.');
          return;
        }
        if (currentCheckType === CheckType.DIRECT && !comparisonText.trim()) {
          setError('Please enter the comparison text.');
          return;
        }

        setIsLoading(true);
        setError(null);
        setResults(null);

        try {
          let apiResponse = null;
          if (currentCheckType === CheckType.WEB) {
            apiResponse = await checkTextWithGemini(primaryText);
          } else {
            apiResponse = await compareTextsWithGemini(primaryText, comparisonText);
          }
          setResults(apiResponse);
        } catch (e) {
          console.error("Error during analysis:", e);
          setError(e.message || 'An unexpected error occurred. Please try again.');
        } finally {
          setIsLoading(false);
        }
      }, [primaryText, comparisonText, currentCheckType]);

      const radioOptions = [
        { label: 'Check against Web', value: CheckType.WEB },
        { label: 'Compare Two Texts', value: CheckType.DIRECT },
      ];
      
      const toolTitleClasses = "text-4xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";
      
      return (
        React.createElement('div', { className: "w-full max-w-4xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-8" },
          React.createElement('header', { className: "mb-6 text-center" },
             React.createElement('div', { className: "flex items-center justify-center space-x-3 mb-2" },
                React.createElement(LightBulbIcon, { className: "h-10 w-10 text-primary" }),
                React.createElement('h1', { className: toolTitleClasses }, "Plagiarism & AI Checker")
             ),
             React.createElement('p', { className: "text-md text-textLight dark:text-gray-400 max-w-xl mx-auto" }, "Elevate your academic integrity. Check for plagiarism, AI content, and compare texts.")
          ),
          React.createElement('button', {
            onClick: onBack,
            className: "mb-6 inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800"
          }, "â¹ Back to App Selection"),
          React.createElement('section', { className: "space-y-6" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "primaryText", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Enter Text to Analyze:"),
              React.createElement(TextInput, {
                id: "primaryText",
                value: primaryText,
                onChange: (e) => setPrimaryText(e.target.value),
                placeholder: "Paste your essay, article, or any text here...",
                rows: currentCheckType === CheckType.DIRECT ? 6 : 10,
                'aria-label': "Text to Analyze"
              })
            ),
            React.createElement(RadioGroup, {
              options: radioOptions,
              selectedValue: currentCheckType,
              onChange: (value) => setCurrentCheckType(value),
              name: "checkType"
            }),
            currentCheckType === CheckType.DIRECT && (
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "comparisonText", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Enter Comparison Text:"),
                React.createElement(TextInput, {
                  id: "comparisonText",
                  value: comparisonText,
                  onChange: (e) => setComparisonText(e.target.value),
                  placeholder: "Paste the text you want to compare against...",
                  rows: 6,
                  'aria-label': "Comparison Text"
                })
              )
            )
          ),
          React.createElement('div', { className: "text-center" },
            React.createElement('button', {
              onClick: handleCheck,
              disabled: isLoading,
              className: "w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
            },
              isLoading ? (
                React.createElement(React.Fragment, null,
                  React.createElement(LoadingSpinner, { className: "mr-2" }), " Processing..."
                )
              ) : (
                React.createElement(React.Fragment, null,
                  currentCheckType === CheckType.WEB ? React.createElement(DocumentMagnifyingGlassIcon, { className: "h-5 w-5 mr-2" }) : React.createElement(BookOpenIcon, { className: "h-5 w-5 mr-2" }),
                  "Analyze Text"
                )
              )
            )
          ),
          error && (
            React.createElement('div', { className: "mt-6 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md", role: "alert" },
              React.createElement('p', { className: "font-bold" }, "Error"),
              React.createElement('p', null, error)
            )
          ),
          results && !isLoading && !error && (
            React.createElement(ResultsDisplay, { results: results, checkType: currentCheckType })
          )
        )
      );
    };
    // --- END of SuccessStudentTool.tsx content ---

    // --- START of AutoFixTool.tsx content ---
    const AutoFixTool = ({ onBack }) => {
      const [originalText, setOriginalText] = useState('');
      const [correctedText, setCorrectedText] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleFixText = useCallback(async () => {
        if (!originalText.trim()) {
          setError('Please enter the text you want to correct.');
          return;
        }
        setIsLoading(true);
        setError(null);
        setCorrectedText('');

        try {
          const fixedText = await fixTextWithGemini(originalText);
          setCorrectedText(fixedText);
        } catch (e) {
          console.error("Error during text correction:", e);
          setError(e.message || 'An unexpected error occurred. Please try again.');
        } finally {
          setIsLoading(false);
        }
      }, [originalText]);
      
      const toolTitleClasses = "text-4xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";

      return (
        React.createElement('div', { className: "w-full max-w-4xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-8" },
          React.createElement('header', { className: "mb-6 text-center" },
             React.createElement('div', { className: "flex items-center justify-center space-x-3 mb-2" },
                React.createElement(WandSparklesIcon, { className: "h-10 w-10 text-primary" }),
                React.createElement('h1', { className: toolTitleClasses }, "Auto-Fix Writer")
             ),
             React.createElement('p', { className: "text-md text-textLight dark:text-gray-400 max-w-xl mx-auto" }, "Refine your writing effortlessly. Correct grammar, spelling, and improve clarity.")
          ),
           React.createElement('button', {
            onClick: onBack,
            className: "mb-6 inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800"
          }, "â¹ Back to App Selection"),
          React.createElement('section', { className: "space-y-6" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "originalText", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Enter Text to Correct:"),
              React.createElement(TextInput, {
                id: "originalText",
                value: originalText,
                onChange: (e) => setOriginalText(e.target.value),
                placeholder: "Paste your text here to get it automatically corrected...",
                rows: 10,
                'aria-label': "Original Text to Correct"
              })
            ),
            React.createElement('div', { className: "text-center" },
              React.createElement('button', {
                onClick: handleFixText,
                disabled: isLoading,
                className: "w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
              },
                isLoading ? (
                  React.createElement(React.Fragment, null,
                    React.createElement(LoadingSpinner, { className: "mr-2" }), " Correcting..."
                  )
                ) : (
                  React.createElement(React.Fragment, null,
                    React.createElement(WandSparklesIcon, { className: "h-5 w-5 mr-2" }),
                    "Correct My Text"
                  )
                )
              )
            ),
            error && (
              React.createElement('div', { className: "mt-6 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md", role: "alert" },
                React.createElement('p', { className: "font-bold" }, "Error"),
                React.createElement('p', null, error)
              )
            ),
            correctedText && !isLoading && !error && (
              React.createElement('div', { className: "mt-6" },
                React.createElement('label', { htmlFor: "correctedTextOutput", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Corrected Text:"),
                React.createElement(TextInput, {
                  id: "correctedTextOutput",
                  value: correctedText,
                  readOnly: true,
                  rows: 10,
                  className: "bg-gray-50 dark:bg-gray-600 whitespace-pre-wrap", 
                  'aria-label': "Corrected Text"
                })
              )
            )
          )
        )
      );
    };
    // --- END of AutoFixTool.tsx content ---

    // --- START of MLAFormatterTool.tsx content ---
    const MLAFormatterTool = ({ onBack }) => {
      const [studentName, setStudentName] = useState('');
      const [instructorName, setInstructorName] = useState('');
      const [courseName, setCourseName] = useState('');
      const [date, setDate] = useState('');
      const [originalText, setOriginalText] = useState('');
      const [formattedText, setFormattedText] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleFormatText = useCallback(async () => {
        if (!studentName.trim()) { setError('Please enter Student Name.'); return; }
        if (!instructorName.trim()) { setError('Please enter Instructor Name.'); return; }
        if (!courseName.trim()) { setError('Please enter Course Name.'); return; }
        if (!date.trim()) { setError('Please enter Date.'); return; }
        if (!originalText.trim()) {
          setError('Please enter the text you want to format to MLA.');
          return;
        }
        setIsLoading(true);
        setError(null);
        setFormattedText('');

        try {
          const mlaText = await formatTextToMLA({
            studentName,
            instructorName,
            courseName,
            date,
            textToFormat: originalText
          });
          setFormattedText(mlaText);
        } catch (e) {
          console.error("Error during MLA formatting:", e);
          setError(e.message || 'An unexpected error occurred. Please try again.');
        } finally {
          setIsLoading(false);
        }
      }, [originalText, studentName, instructorName, courseName, date]);

      const toolTitleClasses = "text-4xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";

      return (
        React.createElement('div', { className: "w-full max-w-4xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-8" },
          React.createElement('header', { className: "mb-6 text-center" },
             React.createElement('div', { className: "flex items-center justify-center space-x-3 mb-2" },
                React.createElement(AcademicCapIcon, { className: "h-10 w-10 text-primary" }),
                React.createElement('h1', { className: toolTitleClasses }, "MLA Formatter")
             ),
             React.createElement('p', { className: "text-md text-textLight dark:text-gray-400 max-w-xl mx-auto" }, "Format your text to MLA guidelines for proper academic papers, including header and 12pt Times New Roman style.")
          ),
           React.createElement('button', {
            onClick: onBack,
            className: "mb-6 inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800"
          }, "â¹ Back to App Selection"),
          React.createElement('section', { className: "space-y-6" },
            React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-6" },
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "studentName", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Student Name:"),
                React.createElement(TextInput, { id: "studentName", value: studentName, onChange: (e) => setStudentName(e.target.value), placeholder: "e.g., Jane Doe", 'aria-label': "Student Name" })
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "instructorName", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Instructor Name:"),
                React.createElement(TextInput, { id: "instructorName", value: instructorName, onChange: (e) => setInstructorName(e.target.value), placeholder: "e.g., Dr. John Smith", 'aria-label': "Instructor Name" })
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "courseName", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Course Name/Number:"),
                React.createElement(TextInput, { id: "courseName", value: courseName, onChange: (e) => setCourseName(e.target.value), placeholder: "e.g., English 101", 'aria-label': "Course Name" })
              ),
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "date", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Date:"),
                React.createElement(TextInput, { id: "date", value: date, onChange: (e) => setDate(e.target.value), placeholder: "e.g., May 15, 2024 or 15 May 2024", 'aria-label': "Date" })
              )
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "originalMLAText", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Enter Essay/Paper Text:"),
              React.createElement(TextInput, {
                id: "originalMLAText",
                value: originalText,
                onChange: (e) => setOriginalText(e.target.value),
                placeholder: "Paste your raw essay text here. The tool will apply MLA formatting (header, double spacing, paragraph indentation).",
                rows: 8,
                'aria-label': "Original Text to Format to MLA"
              })
            ),
            React.createElement('div', { className: "text-center" },
              React.createElement('button', {
                onClick: handleFormatText,
                disabled: isLoading,
                className: "w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
              },
                isLoading ? (
                  React.createElement(React.Fragment, null,
                    React.createElement(LoadingSpinner, { className: "mr-2" }), " Formatting..."
                  )
                ) : (
                  React.createElement(React.Fragment, null,
                    React.createElement(AcademicCapIcon, { className: "h-5 w-5 mr-2" }),
                    "Format to MLA"
                  )
                )
              )
            ),
            error && (
              React.createElement('div', { className: "mt-6 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md", role: "alert" },
                React.createElement('p', { className: "font-bold" }, "Error"),
                React.createElement('p', null, error)
              )
            ),
            formattedText && !isLoading && !error && (
              React.createElement('div', { className: "mt-6" },
                React.createElement('label', { htmlFor: "formattedMLATextOutput", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "MLA Formatted Text (12pt Times New Roman style):"),
                React.createElement(TextInput, {
                  id: "formattedMLATextOutput",
                  value: formattedText,
                  readOnly: true,
                  rows: 12,
                  className: "bg-gray-50 dark:bg-gray-600 whitespace-pre-wrap font-times-12pt", 
                  'aria-label': "MLA Formatted Text"
                })
              )
            )
          )
        )
      );
    };
    // --- END of MLAFormatterTool.tsx content ---

    // --- START of HumanizerTool.tsx content ---
    const HumanizerTool = ({ onBack }) => {
      const [originalText, setOriginalText] = useState('');
      const [humanizedText, setHumanizedText] = useState('');
      const [selectedGradeLevel, setSelectedGradeLevel] = useState('');
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleHumanizeText = useCallback(async () => {
        if (!originalText.trim()) {
          setError('Please enter the text you want to humanize.');
          return;
        }
        if (!selectedGradeLevel) {
          setError('Please select a target grade level.');
          return;
        }
        setIsLoading(true);
        setError(null);
        setHumanizedText('');

        try {
          const newHumanizedText = await humanizeTextWithGemini(originalText, selectedGradeLevel);
          setHumanizedText(newHumanizedText);
        } catch (e) {
          console.error("Error during text humanization:", e);
          setError(e.message || 'An unexpected error occurred. Please try again.');
        } finally {
          setIsLoading(false);
        }
      }, [originalText, selectedGradeLevel]);

      const toolTitleClasses = "text-4xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";

      return (
        React.createElement('div', { className: "w-full max-w-4xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-8" },
          React.createElement('header', { className: "mb-6 text-center" },
             React.createElement('div', { className: "flex items-center justify-center space-x-3 mb-2" },
                React.createElement(UserGroupIcon, { className: "h-10 w-10 text-primary" }),
                React.createElement('h1', { className: toolTitleClasses }, "Text Humanizer")
             ),
             React.createElement('p', { className: "text-md text-textLight dark:text-gray-400 max-w-xl mx-auto" }, "Make your writing sound more natural, engaging, and clear for your target audience.")
          ),
           React.createElement('button', {
            onClick: onBack,
            className: "mb-6 inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800"
          }, "â¹ Back to App Selection"),
          React.createElement('section', { className: "space-y-6" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "originalHumanizeText", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Enter Text to Humanize:"),
              React.createElement(TextInput, {
                id: "originalHumanizeText",
                value: originalText,
                onChange: (e) => setOriginalText(e.target.value),
                placeholder: "Paste your text here...",
                rows: 8,
                'aria-label': "Original Text to Humanize"
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "gradeLevelSelect", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Target Grade Level:"),
              React.createElement(SelectDropdown, {
                id: "gradeLevelSelect",
                name: "gradeLevel",
                value: selectedGradeLevel,
                onChange: (e) => setSelectedGradeLevel(e.target.value),
                options: GRADE_LEVEL_OPTIONS,
                'aria-label': "Select Target Grade Level"
              })
            ),
            React.createElement('div', { className: "text-center" },
              React.createElement('button', {
                onClick: handleHumanizeText,
                disabled: isLoading,
                className: "w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
              },
                isLoading ? (
                  React.createElement(React.Fragment, null,
                    React.createElement(LoadingSpinner, { className: "mr-2" }), " Humanizing..."
                  )
                ) : (
                  React.createElement(React.Fragment, null,
                    React.createElement(UserGroupIcon, { className: "h-5 w-5 mr-2" }),
                    "Humanize My Text"
                  )
                )
              )
            ),
            error && (
              React.createElement('div', { className: "mt-6 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md", role: "alert" },
                React.createElement('p', { className: "font-bold" }, "Error"),
                React.createElement('p', null, error)
              )
            ),
            humanizedText && !isLoading && !error && (
              React.createElement('div', { className: "mt-6" },
                React.createElement('label', { htmlFor: "humanizedTextOutput", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Humanized Text:"),
                React.createElement(TextInput, {
                  id: "humanizedTextOutput",
                  value: humanizedText,
                  readOnly: true,
                  rows: 10,
                  className: "bg-gray-50 dark:bg-gray-600 whitespace-pre-wrap", 
                  'aria-label': "Humanized Text"
                })
              )
            )
          )
        )
      );
    };
    // --- END of HumanizerTool.tsx content ---

    // --- START of SynonymFinderTool.tsx content ---
    const SynonymFinderTool = ({ onBack }) => {
      const [mode, setMode] = useState(SynonymFinderMode.SINGLE_WORD);
      const [inputText, setInputText] = useState('');
      const [wordsToReplaceText, setWordsToReplaceText] = useState('');
      const [results, setResults] = useState(null);
      const [isLoading, setIsLoading] = useState(false);
      const [error, setError] = useState(null);

      const synonymRadioOptions = [
        { label: 'Single Word Synonyms', value: SynonymFinderMode.SINGLE_WORD },
        { label: 'Contextual Synonyms in Sentence', value: SynonymFinderMode.SENTENCE },
      ];

      const handleFindSynonyms = useCallback(async () => {
        if (!inputText.trim()) {
          setError('Please enter text to find synonyms for.');
          return;
        }
        if (mode === SynonymFinderMode.SENTENCE && !wordsToReplaceText.trim()) {
          setError('Please enter the specific word(s) in the sentence to find synonyms for.');
          return;
        }

        setIsLoading(true);
        setError(null);
        setResults(null);

        try {
          const wordsToReplaceArray = mode === SynonymFinderMode.SENTENCE 
            ? wordsToReplaceText.split(',').map(word => word.trim()).filter(word => word)
            : [];
          
          const apiResponse = await findSynonymsWithGemini(inputText, wordsToReplaceArray, mode);
          
          if (apiResponse.error) {
            setError(apiResponse.error);
            setResults(null);
          } else {
            setResults(apiResponse);
          }

        } catch (e) {
          console.error("Error during synonym finding:", e);
          setError(e.message || 'An unexpected error occurred. Please try again.');
        } finally {
          setIsLoading(false);
        }
      }, [inputText, wordsToReplaceText, mode]);
      
      const renderResults = () => {
        if (!results || isLoading || error) return null;

        if (mode === SynonymFinderMode.SENTENCE && results.sentenceSynonyms) {
          return (
            React.createElement('div', { className: "space-y-4" },
              React.createElement('h3', { className: "text-lg font-semibold text-gray-700 dark:text-gray-300" }, "Contextual Synonym Suggestions:"),
              results.sentenceSynonyms.length === 0 && React.createElement('p', {className: "text-gray-500 dark:text-gray-400"}, "No specific words provided or no synonyms found."),
              results.sentenceSynonyms.map((item, index) => (
                React.createElement('div', { key: index, className: "p-4 bg-gray-50 dark:bg-gray-700 rounded-md shadow-sm" },
                  React.createElement('p', { className: "font-medium text-primary mb-1" }, `Original Word: `, 
                    React.createElement('span', {className: "text-textDark dark:text-gray-200 font-semibold"}, item.originalWord)
                  ),
                  item.message && React.createElement('p', { className: "text-sm text-yellow-600 dark:text-yellow-400 mb-1" }, item.message),
                  item.synonyms && item.synonyms.length > 0 ? (
                    React.createElement('ul', { className: "list-disc list-inside pl-4" },
                      item.synonyms.map((synonym, sIndex) => (
                        React.createElement('li', { key: sIndex, className: "text-sm text-gray-600 dark:text-gray-300" }, synonym)
                      ))
                    )
                  ) : !item.message && React.createElement('p', { className: "text-sm text-gray-500 dark:text-gray-400" }, "No synonyms found for this word in context.")
                )
              ))
            )
          );
        }

        if (mode === SynonymFinderMode.SINGLE_WORD && results.singleWordSynonyms) {
          return (
            React.createElement('div', null,
              React.createElement('h3', { className: "text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2" }, `Synonyms for "${inputText.trim()}":`),
              results.singleWordSynonyms.length > 0 ? (
                React.createElement('ul', { className: "list-disc list-inside space-y-1 bg-gray-50 dark:bg-gray-700 p-3 rounded-md" },
                  results.singleWordSynonyms.map((synonym, index) => (
                    React.createElement('li', { key: index, className: "text-sm text-gray-600 dark:text-gray-300" }, synonym)
                  ))
                )
              ) : React.createElement('p', { className: "text-gray-500 dark:text-gray-400" }, "No synonyms found for this word.")
            )
          );
        }
        return React.createElement('p', {className: "text-gray-500 dark:text-gray-400"}, "No results to display.");
      };

      const toolTitleClasses = "text-4xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";

      return (
        React.createElement('div', { className: "w-full max-w-4xl bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-8" },
          React.createElement('header', { className: "mb-6 text-center" },
            React.createElement('div', { className: "flex items-center justify-center space-x-3 mb-2" },
              React.createElement(LightBulbIcon, { className: "h-10 w-10 text-primary" }),
              React.createElement('h1', { className: toolTitleClasses }, "Synonym Finder")
            ),
            React.createElement('p', { className: "text-md text-textLight dark:text-gray-400 max-w-xl mx-auto" }, "Discover better words, either for a single term or contextually within a sentence.")
          ),
          React.createElement('button', {
            onClick: onBack,
            className: "mb-6 inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800"
          }, "â¹ Back to App Selection"),
          React.createElement('section', { className: "space-y-6" },
            React.createElement(RadioGroup, {
              options: synonymRadioOptions,
              selectedValue: mode,
              onChange: (value) => { setMode(value); setResults(null); setError(null); },
              name: "synonymMode"
            }),
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "inputTextSynonym", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, 
                mode === SynonymFinderMode.SENTENCE ? "Enter Sentence:" : "Enter Word:"
              ),
              React.createElement(TextInput, {
                id: "inputTextSynonym",
                value: inputText,
                onChange: (e) => setInputText(e.target.value),
                placeholder: mode === SynonymFinderMode.SENTENCE ? "e.g., The quick brown fox jumps over the lazy dog." : "e.g., happy",
                rows: mode === SynonymFinderMode.SENTENCE ? 4 : 1,
                'aria-label': mode === SynonymFinderMode.SENTENCE ? "Sentence for synonym search" : "Word for synonym search"
              })
            ),
            mode === SynonymFinderMode.SENTENCE && (
              React.createElement('div', null,
                React.createElement('label', { htmlFor: "wordsToReplace", className: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" }, "Words in sentence to find synonyms for (comma-separated):"),
                React.createElement(TextInput, {
                  id: "wordsToReplace",
                  value: wordsToReplaceText,
                  onChange: (e) => setWordsToReplaceText(e.target.value),
                  placeholder: "e.g., quick, lazy",
                  'aria-label': "Words to find synonyms for"
                })
              )
            ),
            React.createElement('div', { className: "text-center" },
              React.createElement('button', {
                onClick: handleFindSynonyms,
                disabled: isLoading,
                className: "w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
              },
                isLoading ? (
                  React.createElement(React.Fragment, null,
                    React.createElement(LoadingSpinner, { className: "mr-2" }), " Finding..."
                  )
                ) : (
                  React.createElement(React.Fragment, null,
                    React.createElement(LightBulbIcon, { className: "h-5 w-5 mr-2" }),
                    "Find Synonyms"
                  )
                )
              )
            ),
            error && (
              React.createElement('div', { className: "mt-6 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md", role: "alert" },
                React.createElement('p', { className: "font-bold" }, "Error"),
                React.createElement('p', null, error)
              )
            ),
            results && !isLoading && !error && (
                React.createElement('div', { className: "mt-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700" },
                    renderResults()
                )
            )
          )
        )
      );
    };
    // --- END of SynonymFinderTool.tsx content ---

    // --- START of ApiKeyInputScreen.tsx content ---
    const ApiKeyInputScreen = ({ onSubmitApiKey, currentError, isLoading }) => {
      const [apiKey, setApiKey] = useState('');

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!apiKey.trim()) {
          // Propagate error upwards or handle locally if onSubmitApiKey can't show specific errors
          onSubmitApiKey(apiKey); // Let App handle empty key if it wants to
          return;
        }
        onSubmitApiKey(apiKey);
      };

      return (
        React.createElement('div', { className: "w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl space-y-6" },
          React.createElement('header', { className: "text-center" },
            React.createElement('h1', { className: "text-2xl font-bold text-primary dark:text-blue-400" }, "Gemini API Key Required"),
            React.createElement('p', { className: "mt-2 text-sm text-textLight dark:text-gray-400" },
              "To use SuccessStudent, please enter your Google Gemini API key. You can obtain one from Google AI Studio."
            )
          ),
          React.createElement('form', { onSubmit: handleSubmit, className: "space-y-6" },
            React.createElement('div', null,
              React.createElement('label', { htmlFor: "apiKeyInput", className: "block text-sm font-medium text-gray-700 dark:text-gray-300" }, "API Key"),
              React.createElement(TextInput, {
                type: "password", // Keep key hidden
                id: "apiKeyInput",
                value: apiKey,
                onChange: (e) => setApiKey(e.target.value),
                placeholder: "Enter your Gemini API Key",
                required: true,
                'aria-label': "Gemini API Key",
                className: "mt-1"
              })
            ),
            currentError && (
              React.createElement('div', { className: "p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded-md text-sm", role: "alert" },
                currentError
              )
            ),
            React.createElement('div', null,
              React.createElement('button', {
                type: "submit",
                disabled: isLoading,
                className: "w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary hover:bg-accent focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent dark:focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
              },
                isLoading ? (
                  React.createElement(React.Fragment, null,
                    React.createElement(LoadingSpinner, { className: "mr-2" }), "Verifying..."
                  )
                ) : "Submit API Key"
              )
            )
          ),
          React.createElement('p', {className: "text-xs text-center text-gray-500 dark:text-gray-400 mt-4"},
            "Your API key is used locally in your browser and is not stored by this application."
          )
        )
      );
    };
    // --- END of ApiKeyInputScreen.tsx content ---

    // --- START of App.tsx content ---
    const App = () => {
      const [initializationError, setInitializationError] = useState(null);
      const [isInitialized, setIsInitialized] = useState(false);
      const [apiKeyNeeded, setApiKeyNeeded] = useState(false);
      const [apiKeySubmitLoading, setApiKeySubmitLoading] = useState(false);
      const [currentAppView, setCurrentAppView] = useState('appSelection'); // 'appSelection', 'successStudent', 'autoFix', 'mlaFormatter', 'humanizer', 'synonymFinder'

      useEffect(() => {
        // Ensure process.env exists, especially in browser environments without build tools
        if (typeof process === 'undefined') {
          window.process = { env: {} }; 
        }
        // No need for window.PROMPT_GEMINI_API_KEY_FOR_DEV with the input screen logic

        const initResult = initializeGeminiService(); // Attempt auto-init
        if (initResult === true) {
          setIsInitialized(true);
          setInitializationError(null);
          setApiKeyNeeded(false);
        } else if (initResult === 'API_KEY_REQUIRED') {
          setIsInitialized(false);
          setApiKeyNeeded(true);
          setInitializationError(null); // Clear previous generic errors if we now need a key
        } else { // An error string was returned
          setIsInitialized(false);
          setInitializationError(initResult);
          setApiKeyNeeded(false); // Not asking for key if there's another init error
        }
      }, []);
      
      const handleApiKeySubmit = useCallback(async (submittedKey) => {
        if (!submittedKey.trim()) {
            setInitializationError("API Key cannot be empty."); // Show error on ApiKeyInputScreen
            return;
        }
        setApiKeySubmitLoading(true);
        setInitializationError(null); // Clear previous key errors

        const result = initializeGeminiService(submittedKey);
        
        if (result === true) {
          setIsInitialized(true);
          setApiKeyNeeded(false);
          setInitializationError(null);
        } else { // An error string
          setIsInitialized(false);
          // Error will be shown on ApiKeyInputScreen because App re-renders with new initializationError
          setInitializationError(result); 
          setApiKeyNeeded(true); // Keep showing the input screen
        }
        setApiKeySubmitLoading(false);
      }, []);

      const AppCard = ({ icon, title, description, onClick }) => (
        React.createElement('button', {
          onClick: onClick,
          className: "bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg hover:shadow-xl dark:hover:bg-gray-700 transition-shadow duration-200 ease-in-out text-left w-full flex flex-col items-center sm:items-start sm:flex-row space-y-4 sm:space-y-0 sm:space-x-6 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-gray-900"
        },
          React.createElement('div', { className: "flex-shrink-0 text-primary" }, icon),
          React.createElement('div', null,
            React.createElement('h3', { className: "text-xl font-semibold text-primary mb-1" }, title),
            React.createElement('p', { className: "text-textLight dark:text-gray-400 text-sm" }, description)
          )
        )
      );
      
      // Centralized rendering logic
      const renderContent = () => {
        if (apiKeyNeeded && !isInitialized) {
            return React.createElement(ApiKeyInputScreen, { 
                onSubmitApiKey: handleApiKeySubmit, 
                currentError: initializationError, // Pass error to display on input screen
                isLoading: apiKeySubmitLoading 
            });
        }
        if (!isInitialized && initializationError) {
            return (
              React.createElement('div', { className: "w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl text-center" },
                React.createElement('h1', { className: "text-3xl font-bold text-danger dark:text-red-400 mb-4" }, "Initialization Error"),
                React.createElement('p', { className: "text-textLight dark:text-gray-300 mb-2" }, initializationError),
                React.createElement('p', { className: "text-sm text-gray-500 dark:text-gray-400" }, 
                    "Please check your API key or network connection. If you were providing a key, ensure it is correct and try again."
                )
              )
            );
        }
        if (!isInitialized && !apiKeyNeeded && !initializationError) { // Still loading initial check
             return (
                React.createElement('div', { className: "w-full max-w-md bg-white dark:bg-gray-800 p-8 rounded-xl shadow-2xl text-center" },
                    React.createElement(LoadingSpinner, { size: "lg", className: "mx-auto text-primary" }),
                    React.createElement('p', {className: "mt-4 text-textLight dark:text-gray-300"}, "Initializing...")
                )
             );
        }

        // If initialized, show tools or app selection
        switch (currentAppView) {
          case 'successStudent': 
            return React.createElement(SuccessStudentTool, { onBack: () => setCurrentAppView('appSelection') });
          case 'autoFix':
            return React.createElement(AutoFixTool, { onBack: () => setCurrentAppView('appSelection') });
          case 'mlaFormatter':
            return React.createElement(MLAFormatterTool, { onBack: () => setCurrentAppView('appSelection') });
          case 'humanizer':
            return React.createElement(HumanizerTool, { onBack: () => setCurrentAppView('appSelection') });
          case 'synonymFinder':
            return React.createElement(SynonymFinderTool, { onBack: () => setCurrentAppView('appSelection') });
          case 'appSelection':
          default:
            return (
              React.createElement('div', { className: "w-full max-w-2xl space-y-8" },
                React.createElement(AppCard, {
                  icon: React.createElement(LightBulbIcon, { className: "h-12 w-12" }),
                  title: "Plagiarism & AI Checker",
                  description: "Analyze text for originality, detect AI-generated content, and compare documents.",
                  onClick: () => setCurrentAppView('successStudent')
                }),
                React.createElement(AppCard, {
                  icon: React.createElement(WandSparklesIcon, { className: "h-12 w-12" }),
                  title: "Auto-Fix: Writing Corrector",
                  description: "Automatically correct grammar, spelling, and improve the clarity of your text.",
                  onClick: () => setCurrentAppView('autoFix')
                }),
                React.createElement(AppCard, {
                  icon: React.createElement(AcademicCapIcon, { className: "h-12 w-12" }),
                  title: "MLA Formatter",
                  description: "Format your essays and papers according to MLA guidelines (header, 12pt Times New Roman style, double spacing, indentation).",
                  onClick: () => setCurrentAppView('mlaFormatter')
                }),
                React.createElement(AppCard, {
                  icon: React.createElement(UserGroupIcon, { className: "h-12 w-12" }),
                  title: "Text Humanizer",
                  description: "Refine your writing to sound more natural, engaging, and authentic for various grade levels.",
                  onClick: () => setCurrentAppView('humanizer')
                }),
                React.createElement(AppCard, {
                  icon: React.createElement(LightBulbIcon, { className: "h-12 w-12" }), // Re-using LightBulbIcon
                  title: "Synonym Finder",
                  description: "Find context-aware synonyms for words in a sentence or general synonyms for a single word.",
                  onClick: () => setCurrentAppView('synonymFinder')
                })
              )
            );
        }
      };
      
      const mainAppTitleGradientClasses = "text-5xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-700 via-blue-500 to-sky-400 dark:from-blue-500 dark:via-sky-400 dark:to-sky-300";
      const showHeaderAndFooter = isInitialized && !apiKeyNeeded;

      return (
        React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-gray-100 to-blue-100 dark:from-gray-900 dark:to-slate-800 text-textDark dark:text-gray-200 flex flex-col items-center justify-center py-8 px-4 sm:px-6 lg:px-8" },
          showHeaderAndFooter && currentAppView === 'appSelection' && React.createElement('header', { className: "mb-10 text-center" },
            React.createElement('h1', { className: mainAppTitleGradientClasses }, "SuccessStudent"),
            React.createElement('p', { className: "mt-3 text-lg text-textLight dark:text-gray-300 max-w-2xl mx-auto" }, "Choose a tool to enhance your academic and writing excellence.")
          ),
          React.createElement('main', { className: "w-full flex justify-center" },
            renderContent()
          ),
          showHeaderAndFooter && React.createElement('footer', { className: "mt-12 text-center text-sm text-gray-500 dark:text-gray-400" },
            React.createElement('p', null, `Â© ${new Date().getFullYear()} SuccessStudent. Empowering Excellence.`)
          )
        )
      );
    };
    // --- END of App.tsx content ---
    // --- START of index.tsx content ---
    const rootElement = document.getElementById('root');
    if (!rootElement) {
      throw new Error("Could not find root element to mount to");
    }
    const root = ReactDOM.createRoot(rootElement);
    root.render(
      React.createElement(StrictMode, null,
        React.createElement(App, null)
      )
    );
    // --- END of index.tsx content ---
  </script>
</body>
</html>
<link rel="stylesheet" href="index.css">
<script src="index.tsx" type="module"></script>
